Use the SQL database created by the infrastructure deployment.

Connection string format for Azure SQL with Managed Identity:

Server=tcp:{server}.database.windows.net,1433;Initial Catalog=Northwind;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;Authentication=Active Directory Managed Identity;User Id={managed-identity-client-id};

Critical requirements:

1. The connection string MUST include the User Id parameter set to the managed identity's Client ID (not Object ID or Principal ID). Without this, DefaultAzureCredential cannot determine which identity to use.

2. Do NOT use any other authentication methods like username/password, access tokens, or connection.AccessToken. Use only "Authentication=Active Directory Managed Identity" in the connection string.

3. The appsettings.json should have a placeholder connection string. The actual values are set via App Service configuration (environment variables) during infrastructure deployment.

4. For local development, use "Authentication=Active Directory Default" instead of "Active Directory Managed Identity". This allows developers to authenticate using their Azure CLI credentials (az login).

Example appsettings.Development.json for local development:

    "ConnectionStrings": {
        "DefaultConnection": "Server=tcp:sql-server.database.windows.net,1433;Initial Catalog=Northwind;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;Authentication=Active Directory Default;"
    }

Common issues and fixes:

- "Unable to load the proper Managed Identity": The AZURE_CLIENT_ID environment variable is not set or the User Id is missing from the connection string
- "These two approaches conflict with each other": You have both AccessToken and Authentication in the connection string - remove the AccessToken approach
- "Login failed for user": The managed identity database user was not created or does not have proper permissions

The infrastructure deployment script (deploy-infra/deploy.ps1) automatically configures the ConnectionStrings__DefaultConnection app setting with the correct values.
